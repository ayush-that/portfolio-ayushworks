---
title: "첫 번째 컴퓨터 비전 프로젝트 만들기"
description: Python, OpenCV, 손 감지를 사용하여 솔로 탁구 게임을 만듭니다. 단계별 가이드 포함. 컴퓨터 비전 초보자에게 완벽
tags: ["computer-vision", "python", "opencv"]
date: 2024-07-13
published: true
cover: "./images/cover/build-your-first-computer-vision-project.avif"
---

탁구를 치고 싶지만 파트너가 없었던 적이 있나요? 약간의 코딩과 [컴퓨터 비전](https://en.wikipedia.org/wiki/Computer_vision)으로 혼자서 플레이할 수 있는 솔로 [탁구](https://en.wikipedia.org/wiki/Table_tennis) 게임을 만들 수 있습니다!

이 블로그 포스트에서는 Python, [OpenCV](https://opencv.org/), 손 감지 모듈을 사용하여 이 게임을 만드는 방법을 단계별로 안내합니다.

## SoloPong 데모

솔로 탁구 게임의 실제 동작을 보려면 아래 데모 비디오를 확인하세요. 웹캠으로 감지된 손 제스처를 사용하여 게임을 플레이합니다.

<iframe
  width="560"
  height="315"
  src="https://www.youtube.com/embed/4_GEyFlE7M0?si=lV-2RyX04tJkmqgK"
  title="YouTube video player"
  frameborder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
  referrerpolicy="strict-origin-when-cross-origin"
  allowfullscreen
></iframe>
GitHub - [https://github.com/ayush-that/SoloPong](https://github.com/ayush-that/SoloPong)

## 필요한 것

- 컴퓨터에 설치된 [Python](https://www.python.org/downloads/)
- 웹캠
- [GitHub](https://github.com/ayush-that/SoloPong) 리포지토리의 게임용 이미지 에셋(공, 배트, 배경, 게임 오버 화면)

  ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1720892343515/26fd1a83-f262-4f47-baad-793403574a9b.png)

## 코드 작성

1. **라이브러리 임포트 및 카메라 설정**

```python
import numpy as np
import cv2 as cv
import cvzone
from cvzone.HandTrackingModule import HandDetector

cap = cv.VideoCapture(0)
cap.set(3, 1280)
cap.set(4, 720)
```

먼저 필요한 라이브러리를 임포트합니다. 이미지 처리에 OpenCV(`cv`), 손 감지에 `cvzone`, 수치 연산에 [NumPy](https://numpy.org/doc/stable/)(`np`)를 사용합니다. 그런 다음 해상도 1280x720으로 웹캠을 설정합니다.

2. **이미지 에셋 로드**

```python
imgBg = cv.imread("assets/bg.png")
imgGO = cv.imread("assets/gameover.png")
imgBall = cv.imread("assets/ball.png", cv.IMREAD_UNCHANGED)
imgBat1 = cv.imread("assets/bat1.png", cv.IMREAD_UNCHANGED)
imgBat2 = cv.imread("assets/bat2.png", cv.IMREAD_UNCHANGED)
```

배경, 게임 오버 화면, 공, 배트 이미지를 로드합니다. assets 폴더에 이러한 이미지가 있는지 확인하세요.

3. **손 감지기 설정**

```python
detector = HandDetector(detectionCon=0.8, maxHands=2)
```

감지 신뢰도 0.8로 최대 2개의 손을 감지할 수 있는 손 감지기를 초기화합니다.

4. **게임 변수 초기화**

```python
ballPos = [100, 100]
speedX = 25
speedY = 25
gameOver = False
score = [0, 0]
```

공의 초기 위치와 속도를 설정합니다. 게임 오버 플래그와 점수도 초기화합니다.

5. **메인 게임 루프**

```python
while True:
    _, img = cap.read()
    img = cv.flip(img, 1)
    imgRaw = img.copy()
```

메인 게임 루프에 들어가 웹캠에서 프레임을 읽고 거울 효과를 위해 수평으로 뒤집습니다. 원본 프레임의 복사본도 만듭니다.

6. **손 감지 및 배트 오버레이**

```python
hands, img = detector.findHands(img, flipType=False)
img = cv.addWeighted(img, 0.1, imgBg, 0.9, 0)

if hands:
    for hand in hands:
        x, y, w, h = hand["bbox"]
        h1, w1, _ = imgBat1.shape
        y1 = y - h1 // 2
        y1 = np.clip(y1, 20, 415)

        if hand["type"] == "Left":
            img = cvzone.overlayPNG(img, imgBat1, (59, y1))
            if 59 < ballPos[0] < 59 + w1 and y1 < ballPos[1] < y1 + h1:
                speedX = -speedX
                ballPos[0] += 30
                score[0] += 1

        if hand["type"] == "Right":
            img = cvzone.overlayPNG(img, imgBat2, (1195, y1))
            if 1195 - 50 < ballPos[0] < 1195 and y1 < ballPos[1] < y1 + h1:
                speedX = -speedX
                ballPos[0] -= 30
                score[1] += 1
```

프레임에서 손을 감지하고 손 위치에 따라 배트를 오버레이합니다. 공이 배트에 닿으면 방향이 바뀌고 점수가 업데이트됩니다.

7. **공 이동 및 충돌 감지**

```python
if ballPos[0] < 40 or ballPos[0] > 1200:
    gameOver = True
if gameOver:
    img = imgGO
    cv.putText(
        img,
        str(score[1] + score[0]).zfill(2),
        (585, 360),
        cv.FONT_HERSHEY_COMPLEX,
        2.5,
        (200, 0, 200),
        5,
    )

else:
    if ballPos[1] >= 500 or ballPos[1] <= 10:
        speedY = -speedY

    ballPos[0] += speedX
    ballPos[1] += speedY

    img = cvzone.overlayPNG(img, imgBall, ballPos)
    cv.putText(
        img,
        str(score[0]),
        (300, 650),
        cv.FONT_HERSHEY_COMPLEX,
        3,
        (255, 255, 255),
        5,
    )
    cv.putText(
        img,
        str(score[1]),
        (900, 650),
        cv.FONT_HERSHEY_COMPLEX,
        3,
        (255, 255, 255),
        5,
    )
```

공의 위치를 업데이트하고 화면 가장자리와의 충돌을 확인합니다. 공이 경계를 벗어나면 게임 오버가 됩니다. 그렇지 않으면 공의 위치를 계속 업데이트하고 프레임에 오버레이합니다.

8. **게임 표시**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1720892600594/523b8490-cba7-45c6-b6cd-3b516b3ff6dc.png)

```python
img[580:700, 20:233] = cv.resize(imgRaw, (213, 120))
cv.imshow("Image", img)
key = cv.waitKey(1)
if key == ord("r"):
    ballPos = [100, 100]
    speedX = 25
    speedY = 25
    gameOver = False
    score = [0, 0]
    imgGO = cv.imread("assets/gameover.png")
```

게임 프레임을 표시하고 "R" 키를 눌러 게임을 리셋합니다.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1720892568086/67aa413b-01c6-4c90-b153-2239c04e13ef.png)

끝까지 읽어주셔서 감사합니다! 자신만의 솔로 탁구 게임을 만들고 즐기세요. 질문이나 문제가 있으면 댓글로 남겨주세요.
