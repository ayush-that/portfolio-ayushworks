---
title: "Construye tu Primer Proyecto de Visión por Computadora"
description: Crea un juego de ping pong en solitario usando Python, OpenCV y detección de manos. Guía paso a paso incluida. Perfecto para principiantes en visión por computadora
tags: ["computer-vision", "python", "opencv"]
date: 2024-07-13
published: true
cover: "./images/cover/build-your-first-computer-vision-project.avif"
---

¿Alguna vez quisiste jugar ping pong pero no tenías compañero? Bueno, con un poco de programación y [visión por computadora](https://en.wikipedia.org/wiki/Computer_vision), ¡puedes crear un juego de [ping pong](https://en.wikipedia.org/wiki/Table_tennis) en solitario que te permite jugar contra ti mismo!

En esta publicación del blog, te guiaré paso a paso sobre cómo hacer este juego usando Python, [OpenCV](https://opencv.org/) y un módulo de detección de manos.

## Demo de SoloPong

Para ver el juego de ping pong en solitario en acción, mira el video de demostración a continuación. Observa cómo juego usando gestos de manos detectados por la cámara web.

<iframe
  width="560"
  height="315"
  src="https://www.youtube.com/embed/4_GEyFlE7M0?si=lV-2RyX04tJkmqgK"
  title="YouTube video player"
  frameborder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
  referrerpolicy="strict-origin-when-cross-origin"
  allowfullscreen
></iframe>
GitHub - [https://github.com/ayush-that/SoloPong](https://github.com/ayush-that/SoloPong)

## Lo que Necesitarás

- [Python](https://www.python.org/downloads/) instalado en tu computadora
- Una cámara web
- Algunos recursos de imagen para el juego (pelota, paletas, fondo y pantalla de game over) del repositorio de [GitHub](https://github.com/ayush-that/SoloPong)

  ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1720892343515/26fd1a83-f262-4f47-baad-793403574a9b.png)

## Escribiendo el Código

1. **Importando Librerías y Configurando la Cámara**

```python
import numpy as np
import cv2 as cv
import cvzone
from cvzone.HandTrackingModule import HandDetector

cap = cv.VideoCapture(0)
cap.set(3, 1280)
cap.set(4, 720)
```

Comenzamos importando las librerías necesarias. Usamos OpenCV (`cv`) para el procesamiento de imágenes, `cvzone` para la detección de manos y [NumPy](https://numpy.org/doc/stable/) (`np`) para operaciones numéricas. Luego configuramos la cámara web con una resolución de 1280x720.

2. **Cargando Recursos de Imagen**

```python
imgBg = cv.imread("assets/bg.png")
imgGO = cv.imread("assets/gameover.png")
imgBall = cv.imread("assets/ball.png", cv.IMREAD_UNCHANGED)
imgBat1 = cv.imread("assets/bat1.png", cv.IMREAD_UNCHANGED)
imgBat2 = cv.imread("assets/bat2.png", cv.IMREAD_UNCHANGED)
```

Cargamos las imágenes para el fondo, pantalla de game over, pelota y paletas. Asegúrate de tener estas imágenes en la carpeta assets.

3. **Configurando el Detector de Manos**

```python
detector = HandDetector(detectionCon=0.8, maxHands=2)
```

Inicializamos el detector de manos con una confianza de detección de 0.8 y permitimos que detecte hasta 2 manos.

4. **Inicializando Variables del Juego**

```python
ballPos = [100, 100]
speedX = 25
speedY = 25
gameOver = False
score = [0, 0]
```

Establecemos la posición inicial de la pelota y su velocidad. También inicializamos la bandera de game over y el puntaje.

5. **Bucle Principal del Juego**

```python
while True:
    _, img = cap.read()
    img = cv.flip(img, 1)
    imgRaw = img.copy()
```

Entramos al bucle principal del juego, leemos el fotograma de la cámara web y lo volteamos horizontalmente para un efecto de espejo. También hacemos una copia del fotograma original.

6. **Detección de Manos y Superposición de Paletas**

```python
hands, img = detector.findHands(img, flipType=False)
img = cv.addWeighted(img, 0.1, imgBg, 0.9, 0)

if hands:
    for hand in hands:
        x, y, w, h = hand["bbox"]
        h1, w1, _ = imgBat1.shape
        y1 = y - h1 // 2
        y1 = np.clip(y1, 20, 415)

        if hand["type"] == "Left":
            img = cvzone.overlayPNG(img, imgBat1, (59, y1))
            if 59 < ballPos[0] < 59 + w1 and y1 < ballPos[1] < y1 + h1:
                speedX = -speedX
                ballPos[0] += 30
                score[0] += 1

        if hand["type"] == "Right":
            img = cvzone.overlayPNG(img, imgBat2, (1195, y1))
            if 1195 - 50 < ballPos[0] < 1195 and y1 < ballPos[1] < y1 + h1:
                speedX = -speedX
                ballPos[0] -= 30
                score[1] += 1
```

Detectamos las manos en el fotograma y superponemos las paletas basándonos en las posiciones de las manos. Si la pelota golpea una paleta, su dirección cambia y el puntaje se actualiza.

7. **Movimiento de la Pelota y Detección de Colisiones**

```python
if ballPos[0] < 40 or ballPos[0] > 1200:
    gameOver = True
if gameOver:
    img = imgGO
    cv.putText(
        img,
        str(score[1] + score[0]).zfill(2),
        (585, 360),
        cv.FONT_HERSHEY_COMPLEX,
        2.5,
        (200, 0, 200),
        5,
    )

else:
    if ballPos[1] >= 500 or ballPos[1] <= 10:
        speedY = -speedY

    ballPos[0] += speedX
    ballPos[1] += speedY

    img = cvzone.overlayPNG(img, imgBall, ballPos)
    cv.putText(
        img,
        str(score[0]),
        (300, 650),
        cv.FONT_HERSHEY_COMPLEX,
        3,
        (255, 255, 255),
        5,
    )
    cv.putText(
        img,
        str(score[1]),
        (900, 650),
        cv.FONT_HERSHEY_COMPLEX,
        3,
        (255, 255, 255),
        5,
    )
```

Actualizamos la posición de la pelota y verificamos colisiones con los bordes de la pantalla. Si la pelota sale de los límites, el juego termina. De lo contrario, continuamos actualizando la posición de la pelota y la superponemos en el fotograma.

8. **Mostrando el Juego**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1720892600594/523b8490-cba7-45c6-b6cd-3b516b3ff6dc.png)

```python
img[580:700, 20:233] = cv.resize(imgRaw, (213, 120))
cv.imshow("Image", img)
key = cv.waitKey(1)
if key == ord("r"):
    ballPos = [100, 100]
    speedX = 25
    speedY = 25
    gameOver = False
    score = [0, 0]
    imgGO = cv.imread("assets/gameover.png")
```

Mostramos el fotograma del juego y manejamos la tecla "R" para reiniciar el juego.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1720892568086/67aa413b-01c6-4c90-b153-2239c04e13ef.png)

¡Gracias por seguir el tutorial! Diviértete construyendo y jugando tu propio juego de ping pong en solitario. Si tienes alguna pregunta o encuentras problemas, no dudes en dejar un comentario abajo.
