---
title: "Python的解剖学"
description: 从源代码编写到CPU执行，了解Python的内部工作原理，这是为寻求更深入洞察的开发者准备的综合指南
tags: ["python"]
date: 2024-05-17
published: true
cover: "./images/cover/the-anatomy-of-python.avif"
---

Python是我的第一门编程语言。它是一种流行的面向对象语言，以其简单性和多功能性而闻名。作为一种解释型语言，Python使用解释器逐行执行代码，而不是一次性将整个代码编译成机器语言。

在这篇文章中，我们将探索Python的内部工作原理，从编写源代码到执行。了解这些阶段可以帮助开发者理解Python作为编程语言的效率和强大。

## 需要了解的基本术语

在深入了解Python的工作原理之前，让我们先了解一些基本术语：

### **代码编辑器**

这是编写源代码的环境。它是Python程序的起点，开发者在这里用人类可读的格式编写指令。

### **源代码**

在代码编辑器中编写并保存为`.py`文件的人类可读指令。这个文件包含Python编译器将处理的代码。

### **编译阶段**

在这个阶段，Python编译器将源代码转换为字节码，同时检查语法错误。如果没有发现错误，将生成包含字节码的`.pyc`文件。

### **Python虚拟机（PVM）**

PVM是Python的核心运行时引擎。它解释字节码并将其转换为CPU可以执行的机器代码。PVM确保Python代码可以在任何安装了Python解释器的机器上执行，使Python具有高度可移植性。

### **运行中的程序**

一旦生成机器代码，CPU就会执行它，程序执行原始Python脚本中指定的任务和计算。

## Python的执行过程

Python代码在被计算机的CPU执行之前要经历几个阶段。以下是Python代码如何转换为可执行代码的逐步说明：

![代码编辑器](https://cdn.hashnode.com/res/hashnode/image/upload/v1715955234708/e46fbbb2-e325-4197-ae40-7511d6bfebb9.png)

1. ### 编写源代码

   ![](https://live.staticflickr.com/4836/44661017890_eb4f288ffe_b.jpg)

   任何Python程序的第一步是在代码编辑器中编写源代码。这是根据Python语法规则编写的人类可读代码。编写后，这个源代码被保存为`.py`文件。

2. ### 编译为字节码

   ![](https://prepinstadotcom.s3.ap-south-1.amazonaws.com/wp-content/uploads/2020/07/Pythonbyte.webp)

   当执行.py文件时，Python编译器首先读取源代码。在这个阶段，编译器检查任何语法错误。如果没有发现错误，编译器将源代码转换为字节码，生成.pyc文件。与机器代码不同，字节码不能直接由CPU执行，但作为中间表示。

3. ### **Python虚拟机（PVM）解释**

   然后字节码被送入Python虚拟机（PVM）。PVM是一个解释器，读取字节码并将其转换为机器可执行代码。这种转换是逐行进行的，意味着PVM顺序解释和执行每一行字节码。

4. ### CPU执行

   最后，PVM生成的机器代码由CPU执行。只理解二进制代码的CPU执行原始Python程序中指定的任务和计算，产生所需的输出。

## 总结

![](https://www.devopsschool.com/blog/wp-content/uploads/2020/08/python-virtual-machine.png)

Python的内部工作涉及一个多阶段过程，其中源代码被编译为字节码，由PVM解释，最终作为机器代码由CPU执行。

要了解更多，请参考[https://www.geeksforgeeks.org/internal-working-of-python/](https://www.geeksforgeeks.org/internal-working-of-python/)或观看下面由Hitesh Chaudhary（Chai aur Code）制作的YouTube视频。

<iframe
  width="560"
  height="315"
  src="https://www.youtube.com/embed/3HTKc-ZgZbg?si=-I9mzcFKF-TiugI5"
  title="YouTube video player"
  frameborder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
  referrerpolicy="strict-origin-when-cross-origin"
  allowfullscreen
></iframe>
